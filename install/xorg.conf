# ASZ Cam OS - Optimized X11 Configuration
# Configured for Raspberry Pi with camera operations
# Version: 1.0.0

Section "ServerLayout"
    Identifier     "ASZ Cam Layout"
    Screen      0  "ASZ Screen" 0 0
    InputDevice    "ASZ Keyboard" "CoreKeyboard"
    InputDevice    "ASZ Mouse" "CorePointer"
    Option         "AutoAddDevices" "false"
    Option         "AutoEnableDevices" "false"
EndSection

Section "Files"
    ModulePath   "/usr/lib/xorg/modules"
    FontPath     "/usr/share/fonts/X11/misc"
    FontPath     "/usr/share/fonts/X11/cyrillic"
    FontPath     "/usr/share/fonts/X11/100dpi/:unscaled"
    FontPath     "/usr/share/fonts/X11/75dpi/:unscaled"
    FontPath     "/usr/share/fonts/X11/Type1"
    FontPath     "/usr/share/fonts/X11/100dpi"
    FontPath     "/usr/share/fonts/X11/75dpi"
    FontPath     "/usr/share/fonts/truetype"
    FontPath     "/usr/local/share/fonts"
    FontPath     "catalogue:/etc/X11/fontpath.d"
    FontPath     "built-ins"
EndSection

Section "Module"
    Load  "dbe"         # Double buffer extension
    Load  "extmod"      # Extended module
    Load  "glx"         # OpenGL extension
    Load  "record"      # Record extension
    Load  "dri"         # Direct rendering infrastructure
    Load  "dri2"        # DRI2 extension
EndSection

Section "Extensions"
    Option "Composite" "Enable"
    Option "RENDER" "Enable"
    Option "RANDR" "Enable"
    Option "GLX" "Enable"
EndSection

Section "InputDevice"
    Identifier  "ASZ Keyboard"
    Driver      "libinput"
    Option      "XkbModel" "pc105"
    Option      "XkbLayout" "us"
    Option      "XkbVariant" ""
    Option      "XkbOptions" "terminate:ctrl_alt_bksp"
EndSection

Section "InputDevice"
    Identifier  "ASZ Mouse"
    Driver      "libinput"
    Option      "Device" "/dev/input/mice"
    Option      "Protocol" "auto"
    Option      "Emulate3Buttons" "no"
    Option      "ZAxisMapping" "4 5"
    Option      "AccelerationProfile" "2"
    Option      "AccelerationScheme" "predictable"
    Option      "AccelSpeed" "0.4"
EndSection

Section "Monitor"
    Identifier   "ASZ Monitor"
    VendorName   "ASZ Cam OS"
    ModelName    "Default Monitor"
    
    # Common refresh rates
    HorizSync    28.0-80.0
    VertRefresh  43.0-75.0
    
    # Preferred mode (1920x1080 @ 60Hz)
    ModeLine "1920x1080" 148.50 1920 2008 2052 2200 1080 1084 1089 1125 +hsync +vsync
    
    # Additional common modes
    ModeLine "1680x1050" 146.25 1680 1784 1960 2240 1050 1053 1059 1089 -hsync +vsync
    ModeLine "1280x1024" 108.00 1280 1328 1440 1688 1024 1025 1028 1066 +hsync +vsync
    ModeLine "1280x720"   74.25 1280 1390 1430 1650  720  725  730  750 +hsync +vsync
    ModeLine "1024x768"   75.00 1024 1048 1184 1328  768  771  777  806 -hsync -vsync
    
    Option "DPMS" "true"
    Option "PreferredMode" "1920x1080"
EndSection

Section "Device"
    Identifier  "ASZ Graphics"
    Driver      "modesetting"
    
    # Raspberry Pi specific options
    Option      "AccelMethod" "glamor"
    Option      "DRI" "2"
    Option      "HWComposer" "true"
    
    # Performance options
    Option      "TearFree" "true"
    Option      "SwapbuffersWait" "true"
    
    # Memory management
    Option      "ShadowFB" "false"
    Option      "DoubleBuffer" "true"
    
    # Color depth
    Option      "DefaultDepth" "24"
    
    # Cursor options
    Option      "HWCursor" "true"
    Option      "SWCursor" "false"
    
    # Video memory
    VideoRam    128000
    
    # Bus identification (will be auto-detected)
    # BusID       "PCI:0:2:0"
EndSection

Section "Screen"
    Identifier "ASZ Screen"
    Device     "ASZ Graphics"
    Monitor    "ASZ Monitor"
    DefaultDepth     24
    
    SubSection "Display"
        Depth       8
        Modes      "1920x1080" "1680x1050" "1280x1024" "1280x720" "1024x768"
        ViewPort    0 0
        Virtual     1920 1080
    EndSubSection
    
    SubSection "Display"
        Depth       15
        Modes      "1920x1080" "1680x1050" "1280x1024" "1280x720" "1024x768"
        ViewPort    0 0
        Virtual     1920 1080
    EndSubSection
    
    SubSection "Display"
        Depth       16
        Modes      "1920x1080" "1680x1050" "1280x1024" "1280x720" "1024x768"
        ViewPort    0 0
        Virtual     1920 1080
    EndSubSection
    
    SubSection "Display"
        Depth       24
        Modes      "1920x1080" "1680x1050" "1280x1024" "1280x720" "1024x768"
        ViewPort    0 0
        Virtual     1920 1080
    EndSubSection
    
    Option "AccelMethod" "glamor"
    Option "DRI" "true"
    Option "Composite" "Enable"
    Option "BackingStore" "true"
    Option "TripleBuffer" "true"
EndSection

Section "DRI"
    Mode 0666
EndSection

Section "ServerFlags"
    Option "AutoAddDevices" "false"
    Option "AutoEnableDevices" "false"
    Option "BlankTime" "0"
    Option "StandbyTime" "0"
    Option "SuspendTime" "0"
    Option "OffTime" "0"
    Option "DefaultServerLayout" "ASZ Cam Layout"
    
    # Performance options
    Option "NoTrapSignals" "true"
    Option "DontZap" "false"
    Option "DontZoom" "true"
    
    # Logging
    Option "Log" "sync"
EndSection

# Additional configuration for specific hardware
Section "OutputClass"
    Identifier "Raspberry Pi Graphics"
    MatchDriver "vc4"
    Driver "modesetting"
    Option "AccelMethod" "glamor"
    Option "DRI" "2"
EndSection